---
title: "WASH IPD figure and tables"
author: "Andrew Mertens"
date: "1/3/2021"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(warn = -1) 
library(janitor)
library(knitr)
library(here)
library(table1)
library(rvest)

source(here("0-config.R"))


op = function(x, d=2) sprintf(paste0("%1.",d,"f"), x) 
 library(pander)
panderOptions('digits', 2)
panderOptions('round', 2)
panderOptions('keep.trailing.zeros', TRUE)
panderOptions('graph.fontsize', 8)

panderOptions('table.alignment.default', function(df)
    ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)

load(here("figures/all_tables.Rdata"))
load(here("figures/all_figures.Rdata"))

```

## Table 1. Prevalence of pathogens by sample type tested in each study

```{r, echo=F, warning=F, message=F}
knitr::kable(target_presence_P)

```

## Table 2. Prevalence of microbial source tracking markers by sample type tested in each study

```{r, echo=F, warning=F, message=F}
knitr::kable(target_presence_MST)

```


## Primary figures


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}

p_1

```

__Figure 1.__ Forest plots of intervention effects on any enteropathogen, and any general,  human and animal MST markers in different samples of environmental samples.

```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s1
```

__Figure S1.__ Prevalence of any virus, any bacteria, any protozoa and any STH 


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s3
```

__Figure S3.__ Prevalence of specific pathogens 


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s4
```
__Figure S4.__ Prevalence of specific MST markers 


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s5
```

__Figure S5.__ Abundance of specific pathogens 


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s6
```

__Figure S6.__ Abundance of specific MST markers 


```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10}
p_s7
```

__Figure S7.__ Repeat of Figure 1, adjusted  


<!-- # ```{r, echo=F, warning=F, message=F, fig.width = 10, fig.height = 10} -->
<!-- # p_s8 -->
<!-- # ``` -->

__Figure S8.__ Repeat of Figure 1, broken down by rural/urban.

__Figure S9.__ Repeat of Figure 1, broken down by season. 

__Figure S10.__ Repeat of Figure 1, broken down by  animal ownership.




## Tables

#### MST/pathogen targets by sample sample and study

```{r, echo=F, warning=F, message=F}


tab1

            
```

#### Any pathogens + specific pathogens prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(any_pathogens_tab)
```

#### Any virus + specific virus prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(any_virus_tab)
```

#### Any bacteria + specific bacteria prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(any_bacteria_tab)
```

#### Any helminth + specific helminth prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(any_helminth_tab)
```

#### Any protozoa + specific protozoa prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(any_protozoa_tab)
```

#### Any general MST + specific general MST prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(general_MST_tab)
```

#### Any animal MST + specific animal MST prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(animal_MST_tab)
```

#### Any human MST + specific human MST prevalences (N) and mean abundances by study

```{r, echo=F, warning=F, message=F}
knitr::kable(human_MST_tab)
```



#### Covariate summaries by study (tabulation in progress for Gram Vikas)

```{r, echo=F, warning=F, message=F}

tab2
            
```
